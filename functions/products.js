!function(t,e){for(var n in e)t[n]=e[n]}(exports,function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e){t.exports=require("aws-sdk")},function(t,e){t.exports=require("crypto")},function(t,e){t.exports=require("dotenv")},function(t,e,n){"use strict";n.r(e),n.d(e,"handler",(function(){return E}));var r=n(0),o=n.n(r),i=n(1),u=n.n(i);function s(t,e,n,r,o,i,u){try{var s=t[i](u),a=s.value}catch(t){return void n(t)}s.done?e(a):Promise.resolve(a).then(r,o)}var a=function(){var t,e=(t=function*(t,e){var{title:n}=t.body&&JSON.parse(t.body),r={TableName:process.env.PRODUCTS_TABLE_NAME||"",Item:{id:u.a.randomBytes(16).toString("hex"),title:n}};try{return yield e.put(r).promise(),{statusCode:200,body:JSON.stringify(r.Item)}}catch(t){return{statusCode:500,body:JSON.stringify(t)}}},function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function u(t){s(i,r,o,u,a,"next",t)}function a(t){s(i,r,o,u,a,"throw",t)}u(void 0)}))});return function(t,n){return e.apply(this,arguments)}}();function c(t,e,n,r,o,i,u){try{var s=t[i](u),a=s.value}catch(t){return void n(t)}s.done?e(a):Promise.resolve(a).then(r,o)}var d=function(){var t,e=(t=function*(t,e,n){var r=n,o={TableName:process.env.PRODUCTS_TABLE_NAME||"",Key:{id:r}};try{return yield e.delete(o).promise(),{statusCode:200,body:JSON.stringify(o.Key)}}catch(t){return{statusCode:500,body:JSON.stringify(t)}}},function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function u(t){c(i,r,o,u,s,"next",t)}function s(t){c(i,r,o,u,s,"throw",t)}u(void 0)}))});return function(t,n,r){return e.apply(this,arguments)}}();function f(t,e,n,r,o,i,u){try{var s=t[i](u),a=s.value}catch(t){return void n(t)}s.done?e(a):Promise.resolve(a).then(r,o)}var l=function(){var t,e=(t=function*(t,e,n){var r=n,o={TableName:process.env.PRODUCTS_TABLE_NAME||"",Key:{id:r}};try{var i=yield e.get(o).promise();return{statusCode:200,body:JSON.stringify(i.Item)}}catch(t){return{statusCode:500}}},function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function u(t){f(i,r,o,u,s,"next",t)}function s(t){f(i,r,o,u,s,"throw",t)}u(void 0)}))});return function(t,n,r){return e.apply(this,arguments)}}();function y(t,e,n,r,o,i,u){try{var s=t[i](u),a=s.value}catch(t){return void n(t)}s.done?e(a):Promise.resolve(a).then(r,o)}var v=function(){var t,e=(t=function*(t,e){var n={TableName:process.env.PRODUCTS_TABLE_NAME||""};try{var r=yield e.scan(n).promise();return{statusCode:200,body:JSON.stringify(r.Items)}}catch(t){return{statusCode:500}}},function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function u(t){y(i,r,o,u,s,"next",t)}function s(t){y(i,r,o,u,s,"throw",t)}u(void 0)}))});return function(t,n){return e.apply(this,arguments)}}();function p(t,e,n,r,o,i,u){try{var s=t[i](u),a=s.value}catch(t){return void n(t)}s.done?e(a):Promise.resolve(a).then(r,o)}var h=function(){var t,e=(t=function*(t,e,n){var r=n,{title:o}=t.body&&JSON.parse(t.body),i={TableName:process.env.PRODUCTS_TABLE_NAME||"",Item:{id:r,title:o}};try{return yield e.put(i).promise(),{statusCode:200,body:JSON.stringify(i.Item)}}catch(t){return{statusCode:500}}},function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function u(t){p(i,r,o,u,s,"next",t)}function s(t){p(i,r,o,u,s,"throw",t)}u(void 0)}))});return function(t,n,r){return e.apply(this,arguments)}}(),m=process.env.ACTIVE_ENV||"production";console.log("Using environment config: '".concat(m,"'")),n(2).config({path:".env.".concat(m)});var b=new o.a.Config;b.update({accessKeyId:process.env.AYUSH_ACCESS_KEY_ID,secretAccessKey:process.env.AYUSH_SECRET_ACCESS_KEY});var T=new o.a.DynamoDB.DocumentClient(b),g=["https://heyayush.com","https://www.heyayush.com","http://heyayush.com","http://heyayush.com"],E=(t,e,n)=>{var r,o,i,u=t.headers.origin||t.headers.host;if(o=(t=>{if(t)return t.includes("localhost:")})(r=u),i=g.indexOf(r)>-1,!o&&!i)return console.error("Origin not allowed"),void n(null,{statusCode:401,body:"Unauthorized origin",headers:{"Content-Type":"text/plain"}});var s=t.path.replace(/\.netlify\/functions\/[^/]+/,"").split("/").filter(t=>t);switch(t.httpMethod){case"GET":return 0===s.length?v(t,T):1===s.length?l(t,T,s[0]):{statusCode:500,body:"too many segments in GET request"};case"POST":return a(t,T);case"PUT":return 1===s.length?h(t,T,s[0]):{statusCode:500,body:"invalid segments in POST request, must be /.netlify/functions/api/123456"};case"DELETE":return 1===s.length?d(t,T,s[0]):{statusCode:500,body:"invalid segments in DELETE request, must be /.netlify/functions/api/123456"};default:return{statusCode:500,body:"unrecognized HTTP Method, must be one of GET/POST/PUT/DELETE"}}}}]));